"use strict";(self.webpackChunkminima_docs=self.webpackChunkminima_docs||[]).push([[8637],{5254:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var i=t(5893),a=t(1151);const o={sidebar_position:2},s="Uni-Directional Channel",r={id:"buildonminima/txntutorial/layer2/unidirectionalpayment",title:"Uni-Directional Channel",description:"I want to pay someone 1 Minima a day, everyday, for 30 days. How could I do this without using normal on chain transactions?",source:"@site/docs/buildonminima/txntutorial/layer2/unidirectionalpayment.md",sourceDirName:"buildonminima/txntutorial/layer2",slug:"/buildonminima/txntutorial/layer2/unidirectionalpayment",permalink:"/docs/buildonminima/txntutorial/layer2/unidirectionalpayment",draft:!1,unlisted:!1,editUrl:"https://github.com/minima-global/minidocs/docs/buildonminima/txntutorial/layer2/unidirectionalpayment.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Introduction",permalink:"/docs/buildonminima/txntutorial/layer2/intro"},next:{title:"Bi-Directional Channel",permalink:"/docs/buildonminima/txntutorial/layer2/bidirectionalpayment"}},c={},l=[];function h(n){const e={code:"code",em:"em",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.a)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"uni-directional-channel",children:"Uni-Directional Channel"}),"\n",(0,i.jsx)(e.p,{children:"I want to pay someone 1 Minima a day, everyday, for 30 days. How could I do this without using normal on chain transactions?"}),"\n",(0,i.jsx)(e.p,{children:"Well - one way could be:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Ask the recipient for their address"}),"\n",(0,i.jsx)(e.li,{children:"On day 1 create a valid signed transaction paying them 1 Minima - but don't post it on chain. Just give it to them."}),"\n",(0,i.jsx)(e.li,{children:"On day 2 create another valid signed transaction paying them 2 Minima - but don't post it on chain. Just give it to them. They discard the old transaction, and keep the newer one paying them more.."}),"\n",(0,i.jsx)(e.li,{children:"Keep doing this for 30 days"}),"\n",(0,i.jsx)(e.li,{children:"On the last day the recipient posts the last transaction and collects their 30 Minima."}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"There we go, 30 transactions, off chain, with only one transaction actually going on chain at the end of our financial relationship."}),"\n",(0,i.jsxs)(e.p,{children:["BUT - although this ",(0,i.jsx)(e.em,{children:"seems"})," to work, an element of 'Trust' is required. The recipient can check the transaction is valid when they get it - but there is nothing to stop me spending the coins I use in the transactions, late at night on the 29th day, thus invalidating their transaction. I effectively run off with my money. And now the transaction they have is worthless - as they can't post it. The coins are spent."]}),"\n",(0,i.jsx)(e.p,{children:"If they are a friend, someone I know, I would not do this - wouldn't do it anyway.. BUT can we remove the element of Trust altogether so that I can't do that ? Of course we can.. and we use a trick we learnt earlier with our TimeLock and MultiSig contracts."}),"\n",(0,i.jsxs)(e.p,{children:["Here is the timelock multisig contract we could use:",(0,i.jsx)("br",{}),"\r\nMy Public Key is: ",(0,i.jsx)(e.code,{children:"0xMyKey"}),(0,i.jsx)("br",{}),"\r\nTheir Public Key is: ",(0,i.jsx)(e.code,{children:"0xTheirKey"}),(0,i.jsx)("br",{})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"IF @COINAGE GT (35*1728) AND SIGNEDBY(0xMyKey) THEN RETURN TRUE ENDIF RETURN MULTISIG(2 0xMyKey 0xTheirKey)\n"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:"Create this MultiSig contract with the recipient, with a time lock - that allows me to collect the funds in 35 days. ( There are 1728 blocks in a day )"}),"\n",(0,i.jsx)(e.li,{children:"I send 30 Minima to that address. I have now locked those coins up for ~35 days and the only other way of accessing them is if BOTH of us sign."}),"\n",(0,i.jsxs)(e.li,{children:["On day 1 create a valid transaction spending this 30 Minima coin and send 1 Minima to the recipient and the remaining 29 Minima back to me. I sign it. Then give this partially signed transaction to the recipient. They sign it - but ",(0,i.jsx)(e.strong,{children:"DON'T"})," give it back to me. They now have a valid fully signed transaction that they can post at any time and collect 1 Minima."]}),"\n",(0,i.jsxs)(e.li,{children:["On day 2 create a valid transaction spending this 30 Minima coin and send 2 Minima to the recipient and the remaining 28 Minima back to me. I sign it. Then give this partially signed transaction to the recipient. They sign it - but ",(0,i.jsx)(e.strong,{children:"DON'T"})," give it back to me. They now have a valid fully signed transaction that they can post at any time and collect 2 Minima."]}),"\n",(0,i.jsx)(e.li,{children:"Keep doing this for 30 days."}),"\n",(0,i.jsx)(e.li,{children:"On the last day the recipient posts the latest valid transaction and collects 30 Minima."}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Now - we have a system where I cannot spend the funds before the recipient collects his money. This is trustless and secure. If the recipient doesn't collect the funds within 35 days then I can collect the money and send the 30 Minima back to myself. This is why the timelock has to be more than 30 days."}),"\n",(0,i.jsx)(e.p,{children:"Even better - 1 transaction per day is used as a convenience. I could be paying him by the hour or by the minute."}),"\n",(0,i.jsx)(e.p,{children:"None of this is posted on chain until the final transaction so we are only limited by the speed at which we can create newly signed transactions and swap them. You could even do real time payments by the second."}),"\n",(0,i.jsx)(e.p,{children:"One way payments have their uses, but far more useful, are two way."})]})}function d(n={}){const{wrapper:e}={...(0,a.a)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(h,{...n})}):h(n)}},1151:(n,e,t)=>{t.d(e,{Z:()=>r,a:()=>s});var i=t(7294);const a={},o=i.createContext(a);function s(n){const e=i.useContext(o);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),i.createElement(o.Provider,{value:e},n.children)}}}]);